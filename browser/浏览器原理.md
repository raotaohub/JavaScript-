## MDN——浏览器的导航流程

1. 导航,用户输入 url
   1. 判断是有效地址，还是关键字
2. 将url发送给网络请求进程 进行请求
   1. 查询本地是有否存在有效缓存，如果有则直接使用缓存。
   2. 如果没有则进行网络请求流程
      1. DNS 查询
      2. TCP 3次握手 (SYN SYN ACK)
      3. TLS HTTPS协商
      4. 组装好请求，发给网络请求进程。
   3. 等网络请求进程收到相应后交给浏览器进程并处理。
3. 准备解析和渲染

   1. 解析 HTML
      1. 如果解析过程中遇到 JS 和 CSS 文件，会停止渲染和 HTML 的解析（有预加载机制 preload）
   2. 构建 DOM 树
   3. 构建 CSSOM 树
   4. 等待 JS 编译（这个过程中 JS 可能会修改 DOM 或 CSSOM）
   5. 渲染
      1. Style 计算样式阶段，通过合并 DOM & CSSOM 得到 Render 树。
      2. Layout 布局阶段，计算每个元素的大小和位置。（计算出了一个个框）
      3. Paint 绘制阶段，通过`分层`、分块、光栅化将一个个框绘制到屏幕上，必须在 16.6ms 内完成（保证平滑和滚动流程）。
      4. 合成 阶段，当文档是分层绘制时，需要进行合成操作，确保各层以正确的层叠顺序绘制到屏幕上。

   Compositing（合成）
   交互

## 浏览器的构成

- 浏览器是多进程的

  1. 主要`进程`：浏览器用户界面，管理子进程
  2. 渲染`进程`：将 HTML/CSS/JS 渲染成网页

     1. 主`线程`（也称 UI 线程）：负责处理用户界面和 JavaScript 脚本执行。
     2. 渲染`线程`：负责页面渲染、布局和绘制。
     3. JavaScript 引擎`线程`：负责处理 JavaScript 代码的执行。
     4. 定时器`线程`：负责处理 setTimeout 和 setInterval 等定时器事件。
     5. 事件触发`线程`：负责处理各种事件，如鼠标点击、滚动、键盘输入等。
     6. 异步 HTTP 请求`线程`：负责处理异步 HTTP 请求，如 XMLHttpRequest 和 Fetch API。

  3. 网络`进程`：下载网络资源
  4. GPU`进程`：绘制网页
  5. 插件`进程`：加载和运行插件
  6. 等等。。

## TCP/IP 协议在浏览器中的作用

1. IP（网际协议）：把数据包送达目的主机
2. UDP（用户数据包协议）：通过端口号把数据包分发给正确的程序
3. TCP（传输控制协议）：把数据完整地送达应用程序

## 名词解释

> 光栅化（rasterization）是将矢量图形转换为光栅图像的过程.
